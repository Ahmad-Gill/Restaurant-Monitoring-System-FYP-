{% extends "HtmlFiles/Base.html" %}

{% block title %}Analytics Dashboard{% endblock title %}

{% load static %}

{% block body %}

<link href="{% static 'CssFiles/analytics.css' %}" rel="stylesheet">
<link href="{% static 'CssFiles/variables.css' %}" rel="stylesheet">
<link href="{% static 'CssFiles/analytics_tables.css' %}" rel="stylesheet">
<h2 class="dashboard-title">General Analytics Report</h2>

<div class="page-slider">
    <h2><a href="{% url 'analytics_table' %}" class="slider-button {% if active_page == 'Visualization' %}active{% endif %}">Statistics</a></h2>
    <h2><a href="{% url 'analytics' %}" class="slider-button {% if active_page == 'statistics' %}active{% endif %}">Visualization</a></h2>
</div>

<div class="main-container">
    
    <!-- Sidebar for Available Dates -->
    <div class="dates-container">
        <h3>Available Dates</h3>
        {% for date in available_dates %}
            <a href="?date={{ date }}" class="date-link {% if selected_date == date %}selected{% endif %}">{{ date }}</a>
        {% empty %}
            <p>No dates available</p>
        {% endfor %}
    </div>

    <!-- Data Display -->
    <div class="charts-wrapper">
        <!-- Add heading to show when viewing all dates -->
        {% if not selected_date %}
            <h2 class="charts-heading">All Dates Data Overview</h2>
        {% else %}
            <h2 class="charts-heading">Data for {{ selected_date }}</h2>
        {% endif %}
        
        <!-- Top Charts Container - 2 charts side by side -->
        <div class="top-charts-container">
            <div class="chart-box top-chart-box">
                <h3 class="chart-title">Popular Dishes</h3>
                <canvas id="barChart"></canvas>
            </div>
            <div class="chart-box top-chart-box">
                <h3 class="chart-title">Peak Hours</h3>
                <canvas id="pieChart"></canvas>
            </div>
        </div>
        
        <!-- Bottom Chart Container - Line chart full width -->
        <div class="bottom-chart-container">
            <div class="chart-box bottom-chart-box">
                <h3 class="chart-title">Customer Trends</h3>
                <canvas id="lineChart"></canvas>
            </div>
        </div>
        
        <!-- Error container -->
        <div id="error-container"></div>
    </div>
</div>

<div id="analyticsData" data-value='{{ analytics_data|safe }}'></div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{% static 'JavaScriptFiles/analytics.js' %}"></script>

{% endblock body %}

